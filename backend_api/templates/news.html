{% extends "layout.html" %}
{% block title %}Tin tức - Dự báo Thời tiết{% endblock %}

{% block content %}
<section class="bg-gray-100 min-h-screen py-8">
    <div class="container mx-auto px-4">
        
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            
            <div class="lg:col-span-3 space-y-6">
                
                {% if news_list and news_list|length > 0 %}
                {% set featured_item = news_list[0] %}
                <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow duration-300">
                    <div class="relative">
                        <img src="{{ featured_item.image }}" alt="Ảnh {{ featured_item.title }}" class="w-full h-80 object-cover" loading="lazy">
                        <div class="absolute inset-0 bg-gradient-to-tr from-green-700 via-green-600 to-yellow-500 opacity-90 p-6 flex flex-col justify-end">
                            <h2 class="text-4xl font-extrabold text-white">DỰ BÁO THỜI TIẾT</h2>
                            <p class="text-xl font-semibold text-white mt-1">Ngày 13/06/2025</p> 
                            <span class="text-xs text-green-800 bg-white rounded-full px-3 py-1 absolute bottom-6 right-6 shadow-lg font-medium">xemthoitiet.vn</span>
                        </div>
                    </div>
                    
                    <div class="p-5">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">{{ featured_item.title }}</h3>
                        <p class="text-gray-600">Ngày 13 tháng 6 năm 2025, tình hình thời tiết tại Việt Nam đang có những diễn biến đáng chú...</p>
                        <a href="#" class="text-green-600 font-medium hover:text-green-800 transition-colors mt-2 inline-block">Đọc chi tiết &rarr;</a>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4">
                    {% for item in news_list[1:] %}
                    <div class="flex bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-shadow duration-300">
                        <div class="flex-shrink-0 w-32 h-32 relative">
                            <img src="{{ item.image }}" alt="Ảnh {{ item.title }}" class="w-full h-full object-cover" loading="lazy">
                            <div class="absolute inset-0 bg-gradient-to-br from-green-600 to-yellow-400 opacity-90 p-2 flex flex-col justify-end">
                                <span class="text-sm font-bold text-white leading-tight">DỰ BÁO THỜI TIẾT</span>
                                <span class="text-xs text-green-800 bg-white rounded px-1 mt-1 inline-block">Ngày {{ 12 - loop.index }}/06/2025</span>
                            </div>
                        </div>
                        
                        <div class="p-4 flex flex-col justify-center">
                            <h4 class="text-base font-semibold text-gray-800 mb-1 hover:text-green-600 transition-colors">{{ item.title }}</h4>
                            <p class="text-xs text-gray-500 line-clamp-2">Ngày {{ 12 - loop.index }} tháng 6 năm 2025, Việt Nam đang chịu tác động rõ rệt từ cơn bão...</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                {% else %}
                <div class="bg-white p-8 rounded-lg text-center border border-gray-200">
                    <p class="text-gray-500 text-lg">Hiện chưa có tin tức nào mới.</p>
                </div>
                {% endif %}
                
            </div>
            
            <div class="lg:col-span-1 space-y-6">
                
                <div class="bg-white rounded-lg shadow-md border border-gray-200 sticky top-4">
                    <h3 class="text-xl font-bold text-gray-800 p-4 border-b border-gray-200">Bài viết mới</h3>
                    <ul class="divide-y divide-gray-100">
                        {% for item in news_list %}
                        <li class="p-3 flex items-center space-x-3 hover:bg-gray-50 transition-colors">
                            <div class="flex-shrink-0 w-16 h-12 relative rounded overflow-hidden">
                                <img src="{{ item.image }}" alt="Ảnh {{ item.title }}" class="w-full h-full object-cover" loading="lazy">
                                <div class="absolute inset-0 bg-gradient-to-br from-green-600 to-yellow-400 opacity-90"></div>
                            </div>
                            <a href="#" class="text-sm text-gray-700 font-medium hover:text-green-600 transition-colors">{{ item.title }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>

                <div id="calendar-block" class="bg-white rounded-lg shadow-md border border-gray-200 p-4">
                    <div class="bg-green-600 text-white text-center py-2 font-bold text-lg rounded-t-lg -mx-4 -mt-4 mb-6">
                        LỊCH VẠN SỰ THÁNG <span id="calendar-month-year"></span>
                    </div>

                    <div class="flex justify-center items-center space-x-4 text-4xl font-extrabold text-gray-800 mb-2">
                        <span id="prev_date" class="prev_date cursor-pointer text-gray-400 hover:text-green-500 transition-colors"> ‹ </span> 
                        <span id="calendar-day" class="text-green-600"> 16 </span>
                        <span id="next_date" class="next_date cursor-pointer text-gray-400 hover:text-green-500 transition-colors"> › </span>
                    </div>
                    
                    <div class="text-center text-sm font-semibold text-red-500 mb-2">Ngày hắc đạo</div>
                    
                    <div class="text-xs text-gray-600 mb-4 text-center">
                        <span class="font-bold text-green-700">Giờ Hoàng Đạo:</span> Dần(3h - 5h), Mão(5h - 7h), <br>Tỵ(9h - 11h), Thân(15h - 17h), <br>Tuất(19h - 21h), Hợi(21h - 23h)
                    </div>
                    
                    <div class="tt_ngay border-t border-gray-200 pt-3 text-sm">
                        <table class="w-full" border="0" cellspacing="0" cellpadding="0">
                            <tbody>
                                <tr>
                                    <td class="text-left font-semibold text-green-500" width="35%">
                                        <div id="calendar-weekday">Chủ nhật</div>
                                    </td>
                                    <td class="text-center font-mono text-gray-800" width="30%">
                                        <span id="calendar-time">20:19:30</span>
                                    </td>
                                    <td class="text-right font-semibold text-green-500" width="35%">
                                        <div id="calendar-lunar-month">Tháng 9</div>
                                        <div class="text-xs font-normal text-gray-500">Âm lịch</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="mt-3 grid grid-cols-3 items-center">
                            <div class="text-xs text-gray-700">
                                <span id="calendar-lunar-hour-day">Giờ Tuất<br>Ngày Kỷ Sửu<br>Tháng Bính Tuất</span>
                            </div>
                            <div class="text-center">
                                <div class="w-8 h-8 mx-auto bg-contain bg-center bg-gray-300 rounded-full"></div> 
                            </div>
                            <div class="text-right">
                                <div id="calendar-lunar-day" class="text-3xl font-extrabold text-green-600 leading-none">27</div>
                                <div id="calendar-lunar-year" class="text-xs font-normal text-gray-500">Năm Ất Tỵ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</section>

<script>
    // Khối JS này giúp Lịch Vạn Sự tự động hiển thị ngày/giờ hiện tại.
    // Lưu ý: Việc tính toán Lịch Âm chính xác cần API hoặc thư viện phức tạp. 
    // Dữ liệu Âm lịch dưới đây được giả lập dựa trên ngày 16/11/2025.
    
    let currentDate = new Date(); // Biến lưu trữ ngày hiện tại (có thể thay đổi bằng nút ‹ ›)

    function updateCalendar(date) {
        // Cập nhật ngày dương lịch
        const options = { weekday: 'long' };
        document.getElementById('calendar-month-year').textContent = `${date.getMonth() + 1}/${date.getFullYear()}`;
        document.getElementById('calendar-day').textContent = date.getDate();
        // Chuyển sang Tiếng Việt và viết hoa chữ cái đầu
        const weekdayName = date.toLocaleDateString('vi-VN', options);
        document.getElementById('calendar-weekday').textContent = weekdayName.charAt(0).toUpperCase() + weekdayName.slice(1);
        
        // Giả lập Lịch Âm (Cần API/Logic phức tạp hơn để tính chính xác cho mọi ngày)
        // Dữ liệu này chỉ mang tính minh họa giao diện
        document.getElementById('calendar-lunar-month').textContent = 'Tháng 9'; 
        document.getElementById('calendar-lunar-day').textContent = '27';
        document.getElementById('calendar-lunar-hour-day').innerHTML = 'Giờ Tuất<br>Ngày Kỷ Sửu<br>Tháng Bính Tuất';
        document.getElementById('calendar-lunar-year').textContent = 'Năm Ất Tỵ';
    }

    // Hàm cập nhật thời gian mỗi giây
    function updateTime() {
        const now = new Date();
        document.getElementById('calendar-time').textContent = now.toLocaleTimeString('en-US', { hour12: false });
    }

    // Khởi tạo lịch
    updateCalendar(currentDate);
    
    // Cập nhật thời gian liên tục
    setInterval(updateTime, 1000);

    // Thêm chức năng chuyển ngày đơn giản (Chỉ đổi ngày dương lịch)
    document.getElementById('prev_date').addEventListener('click', () => {
        currentDate.setDate(currentDate.getDate() - 1);
        updateCalendar(currentDate);
    });

    document.getElementById('next_date').addEventListener('click', () => {
        currentDate.setDate(currentDate.getDate() + 1);
        updateCalendar(currentDate);
    });
</script>
{% endblock %}